# 変更ログ

## 2023-07-24: 記憶と知識の分離

### 変更内容
1. `processWithAI` 関数の修正
   - 記憶（Airtableのチャット履歴）と知識（ML分析結果）を明確に分離
   - GPT-4とClaude-3モデルに対応した処理方法を実装
   - ログメッセージに「記憶」と「知識」の区別を追加

2. モデル別のメッセージ構築方法の最適化
   - GPT-4o-latest: システムプロンプトとユーザーメッセージを別々のメッセージとして処理
   - Claude-3: すべてのコンテキストを単一のメッセージにまとめて処理

3. ML影響分析の改善
   - AI応答内で知識が活用されているかどうかを評価する機能を強化

### 変更理由
従来のシステムでは記憶と知識が混同されており、「昨日の話」のような過去の会話参照に対して適切な応答ができていませんでした。この分離によって、AIの応答生成時に過去の会話（記憶）と分析結果（知識）を明確に区別し、より自然で文脈に沿った対話を実現します。

### 影響範囲
- `server.js`: `processWithAI` 関数の処理フロー
- ログ出力: 記憶と知識の区別が明確になった

### 参照ファイル
- [記憶と知識の分離について](./memory-knowledge-separation.md)

## 変更履歴

### 2023-11-10: 初版実装
- 記憶と知識を明確に分離
- GPT-4とClaude-3の両方に最適なプロンプト形式を実装

### 2023-11-11: モデル処理の統一
- モデル名参照を統一 ('gpt-4o-latest'に標準化)
- ML分析結果の処理を統一 (モデルに関わらず常にsystemメッセージとして追加) 