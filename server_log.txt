Database configuration: Using individual config params
Database pool created successfully
éŸ³å£°åˆ¶é™è¨­å®šã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ: { userDailyLimit: 3, globalMonthlyLimit: 2000, quotaRemoved: false }
æ‹¡å¼µç‰¹æ€§åˆ†æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆæœŸåŒ–å®Œäº† (Gemini æœ‰åŠ¹)
RT Client ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚éŸ³å£°æ©Ÿèƒ½ã¯åˆ¶é™ã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã¾ã™ã€‚
è­¦å‘Š: Azure OpenAIãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°ã®è¨­å®šãŒã‚ã‚Šã¾ã›ã‚“ã€‚å¾“æ¥ã®OpenAIãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã¾ã™ã€‚
0ä»¶ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼éŸ³å£°è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ
éŸ³å£°å‡¦ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆæœŸåŒ–
SemanticSearch module initialized
Semantic search module loaded successfully
Initializing Enhanced Embedding Features...
EmbeddingService initialized with model: text-embedding-3-small
EmbeddingService initialized with model: text-embedding-3-small
EmbeddingService initialized with model: text-embedding-3-small
Embedding features loaded successfully
Loaded 16 services from services.js
First service: "comoly" - "COMOLY"
Sample criteria: {"needs":["is_hikikomori","isolation","seeking_job","remote_work_interest"],"excludes":["has_stable_income"],"topics":["employment","social"],"moods":["anxious","depressed"]}
Service matching module loaded with DEFAULT_CONFIDENCE_THRESHOLD: 0.7 (70%)
Loading saved user analysis data from Airtable...
[2025-03-29T12:17:12.248Z] [ML-ENHANCE] [INFO] MLæ‹¡å¼µãƒ­ã‚¬ãƒ¼åˆæœŸåŒ– - ãƒ¬ãƒ™ãƒ«: info, ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹: false
[2025-03-29T12:17:12.249Z] [ML-ENHANCE] [INFO] MLæ‹¡å¼µãƒ©ãƒƒãƒ‘ãƒ¼ã®åˆæœŸåŒ–ã‚’é–‹å§‹
[2025-03-29T12:17:12.249Z] [ML-ENHANCE] [INFO] MLæ§‹æˆ: {"enabled":false,"modes":{"general":false,"career":false},"fallbackEnabled":true,"loggingLevel":"info"}
[2025-03-29T12:17:12.249Z] [ML-ENHANCE] [INFO] æ‹¡å¼µMLæ©Ÿèƒ½ã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ï¼ˆç’°å¢ƒå¤‰æ•°ML_ENHANCED=trueã§æœ‰åŠ¹åŒ–ï¼‰
[2025-03-29T12:17:12.249Z] [ML-ENHANCE] [INFO] MLæ‹¡å¼µãƒ©ãƒƒãƒ‘ãƒ¼ã®åˆæœŸåŒ–å®Œäº†
No ML data cache found, will create new cache
Airtableæ¥ç¶šãŒåˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ
ãƒ¡ãƒ¢ãƒªã‚¹ãƒˆã‚¢: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...
Initial CONFIDENCE_THRESHOLD set to: 0.7 (70%)
No local recommendations file found, starting with empty array
Loaded 16 service embeddings from file
Enhanced recommendation trigger system initialized
Using model: gpt-4o with rate limit: 20 requests per hour
Enhanced confusion detection system initialized

=== INITIALIZING ENHANCED FEATURES ===
Service matching enhancement initialized
[EnhancedInit] Service recommendation enhancement successfully initialized!
[EnhancedInit] The existing service recommender has been enhanced with better detection.
âœ… Enhanced service recommendations initialized

=== ENHANCED FEATURES INITIALIZATION COMPLETE ===

Restoring system state from persistent storage...
Attempting to restore pending image generation requests...
Listening on port 3000
Visit: http://localhost:3000 (if local)

æ—¢å­˜ã®èªå½™ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ

============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================
ã‚µãƒ³ãƒ—ãƒ«æ„å›³æ¤œå‡ºãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ
Intent detection model initialized successfully
Enhanced Embedding Features successfully initialized.
Embedding features are ready to use.
Failed to enable pgvector extension: could not open extension control file "/opt/homebrew/share/postgresql@14/extension/vector.control": No such file or directory
Will continue without vector search capabilities
Added missing columns to user_messages table
ãƒ¡ãƒ¢ãƒªã‚¹ãƒˆã‚¢: èª­ã¿è¾¼ã¿å®Œäº† (ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿: 3ä»¶, èªå½™: 10èª, ãƒ¢ãƒ‡ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1ä»¶)
Failed to create semantic search tables: type "vector" does not exist
Cleanup function created successfully
Database tables initialized
InsightsService: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®å­˜åœ¨ã‚’ç¢ºèªã—ã¾ã—ãŸ
Initializing Enhanced Embedding Features...
Enhanced Embedding Features successfully initialized.
Embedding features initialized asynchronously
ServiceRecommendations table exists and is accessible
Found 0 recent image generation proposals
No valid pending image requests were found to restore
Successfully restored 0 pending image requests
System state restoration completed
UserAnalysis table is accessible. Loading data...
EmbeddingService initialized with model: text-embedding-3-small
Enhanced service matching module initialized successfully
Enhanced service matching bridge initialized successfully
EmbeddingService initialized with model: text-embedding-3-small
Enhanced image decision module initialized successfully
Enhanced image decision bridge initialized successfully
ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå‘¼ã³å‡ºã•ã‚Œã¾ã—ãŸ: { userId: 'U123456789abcdef123456789abcdef12', text: 'ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„' }
Checking message for mode: ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„
ğŸ“Š ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: ãƒ¢ãƒ¼ãƒ‰æ¤œå‡º "ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„..." => ãƒ¢ãƒ¼ãƒ‰: characteristics, å±¥æ­´åˆ¶é™: 200ä»¶
ğŸ“š ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: ä¼šè©±å±¥æ­´å–å¾—ãƒ—ãƒ­ã‚»ã‚¹é–‹å§‹ - ãƒ¦ãƒ¼ã‚¶ãƒ¼: U123456789abcdef123456789abcdef12

ğŸ“š ==== ä¼šè©±å±¥æ­´å–å¾—ãƒ—ãƒ­ã‚»ã‚¹é–‹å§‹ - ãƒ¦ãƒ¼ã‚¶ãƒ¼: U123456789abcdef123456789abcdef12 ====
ğŸ“š ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹: 200ä»¶ã®ä¼šè©±å±¥æ­´ã‚’å–å¾—ã—ã¾ã™
ğŸ“š [æ¥ç¶šæ¤œè¨¼] Airtableèªè¨¼æƒ…å ± => API_KEYå­˜åœ¨: true, BASE_IDå­˜åœ¨: true
ğŸ“š [æ¥ç¶šæ¤œè¨¼] airtableBaseåˆæœŸåŒ–çŠ¶æ…‹: æˆåŠŸ
ğŸ“š ğŸ” ConversationHistory ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ U123456789abcdef123456789abcdef12 ã®å±¥æ­´ã‚’å–å¾—ä¸­...
ğŸ“š ğŸ“Š ã‚¯ã‚¨ãƒª: UserID="U123456789abcdef123456789abcdef12" ã§æœ€å¤§400ä»¶ã‚’æ™‚é–“é™é †ã§å–å¾—
ğŸ“š âœ… å–å¾—æˆåŠŸ: ConversationHistoryãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰10ä»¶ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã—ãŸ
ğŸ“š ğŸ”„ ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ™‚ç³»åˆ—é †ï¼ˆå¤ã„é †ï¼‰ã«ä¸¦ã¹æ›¿ãˆã¾ã—ãŸ
ğŸ“š ğŸ“ ãƒ¬ã‚³ãƒ¼ãƒ‰å‡¦ç†é–‹å§‹ (10ä»¶)

ğŸ“š ğŸ“‹ ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹é€ ã‚µãƒ³ãƒ—ãƒ« =====
ğŸ“š ğŸ“Œ ãƒ¬ã‚³ãƒ¼ãƒ‰ID: rec6YPxAuTCSKGX6O
ğŸ“š ğŸ“Œ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: {"UserID":"U123456789abcdef123456789abcdef12","Content":"ç§ã®é©è·ã‚’æ•™ãˆã¦ãã ã•ã„","Timestamp":"2025-03-29T12:10:52.450Z","MessageType":"text","Role":"user","Mode":"general"}
ğŸ“š ğŸ“‹ ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹é€ ã‚µãƒ³ãƒ—ãƒ«çµ‚äº† =====

ğŸ“š ğŸ”¢ 10ä»¶ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡¦ç†ã—ã¾ã—ãŸ...
ğŸ“š âœ“ ãƒ¬ã‚³ãƒ¼ãƒ‰å‡¦ç†å®Œäº† (10ä»¶ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ­£å¸¸ã«å‡¦ç†)

ğŸ“Š ======= å±¥æ­´å†…å®¹åˆ†æãƒ‡ãƒãƒƒã‚° =======
ğŸ“Š â†’ åˆ†æå¯¾è±¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: 10ä»¶
ğŸ“Š â†’ ã‚­ãƒ£ãƒªã‚¢é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ä»•äº‹, ã‚­ãƒ£ãƒªã‚¢, è·æ¥­, è»¢è·, å°±è·, åƒãæ–¹, æ¥­ç•Œ, é©è·
ğŸ“Š â†’ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ†æé–‹å§‹...
ğŸ“Š â†’ [ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ 1] ç§ã®é©è·ã‚’æ•™ãˆã¦ãã ã•ã„...
ğŸ“Š â†’ [ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ 3] ç§ã®é©è·ã‚’æ•™ãˆã¦ãã ã•ã„...
ğŸ“Š â†’ [ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ 5] ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„...

ğŸ“Š === åˆ†æã‚µãƒãƒªãƒ¼ ===
ğŸ“Š â†’ ç·ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: 10ä»¶
ğŸ“Š â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: 5ä»¶
ğŸ“Š â†’ ã‚­ãƒ£ãƒªã‚¢é–¢é€£: 2ä»¶ (40%)
ğŸ“Š â†’ ä¼šè©±æœŸé–“: 0æ—¥é–“ (2025/3/29 ã€œ 2025/3/29)
ğŸ“Š â†’ çµè«–: åˆ†æã«ååˆ†ãªå±¥æ­´ã‚ã‚Š (10ä»¶)
ğŸ“Š ======= å±¥æ­´å†…å®¹åˆ†æãƒ‡ãƒãƒƒã‚°çµ‚äº† =======

ğŸ“š âœ… å±¥æ­´å–å¾—å®Œäº†: 10ä»¶ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã—ã¾ã™
ğŸ“š ==== ä¼šè©±å±¥æ­´å–å¾—ãƒ—ãƒ­ã‚»ã‚¹çµ‚äº† - ãƒ¦ãƒ¼ã‚¶ãƒ¼: U123456789abcdef123456789abcdef12 ====

ğŸ“š ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: ä¼šè©±å±¥æ­´å–å¾—å®Œäº†: 10ä»¶
ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: ç‰¹æ€§åˆ†æãƒ¢ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã™
Processing message in mode: characteristics
ç‰¹æ®Šã‚³ãƒãƒ³ãƒ‰ãƒã‚§ãƒƒã‚¯: {"hasDeepAnalysis":false,"hasAskForDetail":false,"hasRecallHistory":false,"hasSearchCommand":false,"hasClaudeRequest":false,"claudeQuery":null,"searchQuery":null}
ğŸ‘” [ã‚­ãƒ£ãƒªã‚¢æ¤œå‡º] ä¸ä¸€è‡´: "ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„"

==== ä¼šè©±å±¥æ­´ãƒ‡ãƒãƒƒã‚°æƒ…å ± ====
â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: U123456789abcdef123456789abcdef12
â†’ å±¥æ­´ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: 0ä»¶

===== ä¼šè©±å±¥æ­´ã®è©³ç´° (æœ€æ–°5ä»¶) =====
â†’ è­¦å‘Š: å±¥æ­´ãŒç©ºã§ã™ã€‚fetchUserHistoryã§ã®å–å¾—ã«å•é¡ŒãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
Using model: chatgpt-4o-latest

=== WORKFLOW VISUALIZATION: AI RESPONSE GENERATION PROCESS ===
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. PARALLEL DATA COLLECTION PHASE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ§  [1S] SEMANTIC SEARCH MODULE - Available

ğŸ“Š [1A] USER NEEDS ANALYSIS - Starting

ğŸ” [1B] CONVERSATION CONTEXT EXTRACTION - Starting
ğŸ“Š Extracting conversation context from 0 messages...
No conversation history available for context extraction.
ğŸ” [1B] CONVERSATION CONTEXT EXTRACTION - Completed in 0ms

ğŸ” [1D] SEMANTIC SEARCH - Starting
Generating embedding for text: ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„...
Generating embedding for text: ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„...
Query error: relation "semantic_embeddings" does not exist
Error finding relevant context: relation "semantic_embeddings" does not exist
ğŸ” [1D] SEMANTIC SEARCH - No relevant contexts found in 885ms
Query error: relation "semantic_embeddings" does not exist
Error storing message embedding: relation "semantic_embeddings" does not exist
Skipping record due to missing data: recNQO9tProJee9AP
Invalid JSON in record recOENOO5qyg4OlgW, skipping: Unexpected token ä¸Š in JSON at position 0
Successfully loaded analysis data for 1510 user-mode combinations
ğŸ“Š [1A] USER NEEDS ANALYSIS - Completed in 17129ms

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. DATA INTEGRATION PHASE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”„ [2.1] Creating final system prompt with all context
    â”œâ”€ [2.1.1] Added user needs analysis
    â”œâ”€ [2.1.2] Added conversation context
    â””â”€ [2.1.5] Final system prompt created: 5761 characters

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. AI RESPONSE GENERATION PHASE                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”„ [3.1] Adding conversation history: 0 messages

ğŸ”„ [3.2] Preparing final prompt with 2 messages

ğŸ¤– [3.3] Calling AI API
Attempting primary model (OpenAI): chatgpt-4o-latest
Error in AI processing: AI response is empty or invalid
Error: AI response is empty or invalid
    at processWithAI (/Users/yuhei/adam-app-cloud-v2.4 - search is implemented./server.js:2323:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /Users/yuhei/adam-app-cloud-v2.4 - search is implemented./server.js:2920:20
Storing interaction => userId: U123456789abcdef123456789abcdef12, role: user, content: ç§ã®ç‰¹æ€§ã‚’åˆ†æã—ã¦ãã ã•ã„
ä¼šè©±å±¥æ­´ã®ä¿å­˜æˆåŠŸ => ãƒ¦ãƒ¼ã‚¶ãƒ¼: U123456789abcdef123456789abcdef12, ã‚¿ã‚¤ãƒ—: user, é•·ã•: 13æ–‡å­—
Storing interaction => userId: U123456789abcdef123456789abcdef12, role: assistant, content: ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãçµŒã£ã¦ã‹ã‚‰ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
ä¼šè©±å±¥æ­´ã®ä¿å­˜æˆåŠŸ => ãƒ¦ãƒ¼ã‚¶ãƒ¼: U123456789abcdef123456789abcdef12, ã‚¿ã‚¤ãƒ—: assistant, é•·ã•: 41æ–‡å­—
